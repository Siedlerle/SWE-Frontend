<!doctype html>
<html>
<div class ="popup-background">
  <div class="popup">
    <button mat-fab (click)="closeCard()" class = "close-Button">
      <mat-icon class ="close-Icon">close</mat-icon>
    </button>

    <div class="card-header">
      <img mat-card-image src="{{backendURL + imageSource}}" onerror="this.src='../../assets/images/nature.jpg'" class="banner">
      <div class="status">{{eventStatus}}</div>
    </div>

    <mat-tab-group class="tab-group" >
      <mat-tab >
        <ng-template mat-tab-label class="mat-tab-label">
          <mat-icon class = "mat-tab-icon">event_note</mat-icon>
          <div class = "mat-tab-labelcontent">
            Eventkarte
          </div>

        </ng-template>
        <h1>{{eventData.name}}</h1>
        <h3>Beschreibung</h3>
        <p>{{eventData.description}}</p>
        <h3>Zeit</h3>
        <ng-container *ngIf="eventData.startDate == eventData.endDate ; else elseBlock">
          <p>
            Beginnt am {{eventData.startDate | date: 'dd.MM.yyyy'}} um {{getFormattedTime(eventData.startTime)}} bis {{getFormattedTime(eventData.startTime)}}
          </p>
        </ng-container>
        <ng-template #elseBlock>
          <p>
            Beginnt am {{eventData.startDate | date: 'dd.MM.yyyy'}} um {{getFormattedTime(eventData.startTime)}}
          </p>
          <p>
            Endet am {{eventData.endDate | date: 'dd.MM.yyyy'}} um {{getFormattedTime(eventData.startTime)}}
          </p>
        </ng-template>

        <h3>Veranstaltungsort</h3>
        <p>
          {{eventData.location}}
        </p>
        <h3>Teilnehmeranzahl</h3>
        <p *ngIf="attendees">
          {{attendees.length}}
        </p>
      </mat-tab>
      <mat-tab >
        <ng-template mat-tab-label class="mat-tab-label">
          <mat-icon class = "mat-tab-icon">info</mat-icon>
          Eventguide
        </ng-template>
        <mat-accordion class="headers-align" multi>
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>
                  Nachrichten an Teilnehmer
                </h3>
              </mat-panel-title>
              <mat-panel-description>
                <mat-icon>chat</mat-icon>
              </mat-panel-description>
            </mat-expansion-panel-header>
            <mat-action-row>
            </mat-action-row>
            <mat-card class="dashboard-card">
              <mat-card-content>
                <div  #chatContainer style="height: 150px; overflow-y: scroll;margin-bottom: 1%">
                  <div>
                    <mat-icon>chevron_right</mat-icon>
                  </div>
                </div>
                <mat-form-field style="display: flex; width: 80%; justify-content: center; align-content: center">
                  <input matInput placeholder="Enter text" >
                  <button mat-icon-button matSuffix >
                    <mat-icon>send</mat-icon>
                  </button>
                </mat-form-field>
              </mat-card-content>
            </mat-card>
          </mat-expansion-panel>
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>
                  Datei hochladen
                </h3>
              </mat-panel-title>
              <mat-panel-description>
                <mat-icon>file_upload</mat-icon>
              </mat-panel-description>
            </mat-expansion-panel-header>
            <mat-action-row>
            </mat-action-row>
            <!--mat-card zum Uploaden und Anzeigen von Dateien-->
            <mat-card class="dashboard-card">
              <mat-card-header style="position: relative; display: flex; width: 100%; margin: 10px">
                <div class="tableControlls"
                     style="position:relative; justify-self: stretch; width: 100%; text-align: right">
                  <mat-card-title style="float: left">Dateien</mat-card-title>
                  <ngx-mat-file-input  style="float: right; margin-right: 45px">
                  </ngx-mat-file-input>
                </div>
              </mat-card-header>
              <mat-card-content>
                <div class = "fileTable">
                  <mat-table [dataSource]="fileDataSource">
                    <ng-container matColumnDef="Filename">
                      <mat-header-cell *matHeaderCellDef>Name</mat-header-cell>
                      <mat-cell *matCellDef="let file">{{file.name}}</mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="Filetype">
                      <mat-header-cell *matHeaderCellDef>Typ der Datei</mat-header-cell>
                      <mat-cell *matCellDef="let file">{{getFileExtension(file.name)}}</mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="Filesize">
                      <mat-header-cell *matHeaderCellDef>Größe der Datei</mat-header-cell>
                      <mat-cell *matCellDef="let file">{{bytesToMegabytes(file.size)}}</mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="actions">
                      <mat-header-cell *matHeaderCellDef>Aktionen</mat-header-cell>
                      <mat-cell *matCellDef="let file">
                        <button mat-icon-button (click)="deleteFile(file)">
                          <mat-icon >delete</mat-icon>
                        </button>
                      </mat-cell>
                    </ng-container>
                    <mat-header-row *matHeaderRowDef="displayedColumnsFiles"></mat-header-row>
                    <mat-row *matRowDef="let row; columns: displayedColumnsFiles;"></mat-row>
                  </mat-table>
                </div>
              </mat-card-content>
            </mat-card>
          </mat-expansion-panel>
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h3>Umfragen erstellen</h3>
              </mat-panel-title>
              <mat-panel-description>
                <mat-icon>
                  rate_review
                </mat-icon>
              </mat-panel-description>
            </mat-expansion-panel-header>
          </mat-expansion-panel>
        </mat-accordion>
      </mat-tab>

      <mat-tab  >
        <ng-template mat-tab-label class="mat-tab-label">
          <mat-icon class="mat-tab-icon">groups</mat-icon>
          Teilnehmerverwaltung
        </ng-template>

        <div class="attende-management-toolbar">
          <button mat-raised-button (click) = "openAddUsertoEvent()" class = "addPerson">
            Teilnehmer hinzufügen
            <mat-icon>person_add</mat-icon>
          </button>

          <div class="search-bar">
            <input class="search-control" type="text" placeholder="Suche"#searchbar>
            <button mat-icon-button class="search-icon">
              <mat-icon>search</mat-icon>
            </button>
          </div>
        </div>
        <div class = "attendeeTable">
          <mat-table [dataSource]="dataSource" matSort class = "">
            <ng-container matColumnDef="FirstName">
              <mat-header-cell *matHeaderCellDef>Vorname</mat-header-cell>
              <mat-cell *matCellDef="let user">{{user.firstname}}</mat-cell>
            </ng-container>

            <ng-container matColumnDef="LastName">
              <mat-header-cell *matHeaderCellDef>Nachname</mat-header-cell>
              <mat-cell *matCellDef="let user">{{user.lastname}}</mat-cell>
            </ng-container>

            <ng-container matColumnDef="eMail">
              <mat-header-cell *matHeaderCellDef>E-Mail-Adresse</mat-header-cell>
              <mat-cell *matCellDef="let user">{{user.emailAdress}}</mat-cell>
            </ng-container>

            <ng-container matColumnDef="attendence">
              <mat-header-cell *matHeaderCellDef>Nimmt Teil</mat-header-cell>
              <mat-cell *matCellDef="let user; let i=index">
                <mat-checkbox [(ngModel)]="isAttending[i]" color="primary"></mat-checkbox>
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="actions">
              <mat-header-cell *matHeaderCellDef>Aktionen</mat-header-cell>
              <mat-cell *matCellDef="let user">
                <button mat-icon-button matTooltip="Teilnehmer absagen" (click)="removeUser(user)" >
                  <mat-icon>
                    delete
                  </mat-icon>
                </button>

              </mat-cell>
            </ng-container>
            <mat-header-row *matHeaderRowDef="displayedColumsAttendees"></mat-header-row>
            <mat-row *matRowDef="let row; columns: displayedColumsAttendees;"></mat-row>
          </mat-table>
        </div>
      </mat-tab>
    </mat-tab-group>

  </div>
</div>
</html>


